(function(){let d=0;const b=new Map;function y(t){const n=t.getAttribute("role");if(n)return n;const i=t.tagName.toLowerCase();return{a:"link",button:"button",input:w(t),select:"combobox",textarea:"textbox",img:"image",nav:"navigation",main:"main",header:"banner",footer:"contentinfo",article:"article",aside:"complementary",section:"region",form:"form",table:"table",tr:"row",th:"columnheader",td:"cell",ul:"list",ol:"list",li:"listitem",h1:"heading",h2:"heading",h3:"heading",h4:"heading",h5:"heading",h6:"heading"}[i]||"generic"}function w(t){const n=t.type.toLowerCase();return{button:"button",submit:"button",reset:"button",checkbox:"checkbox",radio:"radio",range:"slider",search:"searchbox",text:"textbox",email:"textbox",password:"textbox",tel:"textbox",url:"textbox",number:"spinbutton"}[n]||"textbox"}function T(t){var e,a,c;const n=t.getAttribute("aria-label");if(n)return n;const i=t.getAttribute("aria-labelledby");if(i){const o=document.getElementById(i);if(o)return((e=o.textContent)==null?void 0:e.trim())||""}if(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement){const o=t.id;if(o){const s=document.querySelector(`label[for="${o}"]`);if(s)return((a=s.textContent)==null?void 0:a.trim())||""}}const r=t.getAttribute("title");return r||(t instanceof HTMLImageElement?t.alt||"":t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement?t.placeholder||"":(t instanceof HTMLButtonElement||t instanceof HTMLAnchorElement||t.matches("h1, h2, h3, h4, h5, h6"))&&((c=t.textContent)==null?void 0:c.trim().substring(0,50))||"")}function M(t){if(["a","button","input","select","textarea","details","summary"].includes(t.tagName.toLowerCase()))return!0;const i=t.getAttribute("tabindex");if(i&&parseInt(i,10)>=0)return!0;const r=t.getAttribute("role");return!!(r&&["button","link","checkbox","radio","textbox","combobox","listbox","menu","menuitem","tab","slider","spinbutton","switch"].includes(r)||t.getAttribute("onclick")||t.getAttribute("onkeydown"))}function A(t){const n=window.getComputedStyle(t);if(n.display==="none"||n.visibility==="hidden"||n.opacity==="0")return!1;const i=t.getBoundingClientRect();return!(i.width===0||i.height===0)}function E(t="interactive",n=10){d=0,b.clear();const i=[];function r(e,a,c=""){if(a>n||!A(e))return;const o=y(e),s=T(e),x=M(e);if(t==="interactive"&&!x&&o==="generic"){for(const f of e.children)r(f,a,c);return}const h=`ref_${++d}`;b.set(h,new WeakRef(e));let l=`${c}${o}`;s&&(l+=` "${s.substring(0,30)}${s.length>30?"...":""}"`),l+=` [${h}]`;const u=[];e instanceof HTMLAnchorElement&&e.href&&u.push(`href="${e.href.substring(0,50)}${e.href.length>50?"...":""}"`),(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement)&&e.placeholder&&u.push(`placeholder="${e.placeholder}"`),e.disabled&&u.push("disabled"),e.checked&&u.push("checked"),u.length>0&&(l+=` ${u.join(" ")}`),i.push(l);const p=c+"  ";for(const f of e.children)r(f,a+1,p)}return r(document.body,0),i.join(`
`)}function g(t){const n=b.get(t);return n&&n.deref()||null}function L(t){const n=g(t);if(!n)return null;const i=n.getBoundingClientRect();return{x:i.left+i.width/2,y:i.top+i.height/2}}window.__browserControl={generateAccessibilityTree:E,getElementByRef:g,getElementCenter:L};console.log("[A11y Tree] Browser Control content script loaded");
})()
